DROP DATABASE IF EXISTS KinderReview;
CREATE DATABASE KinderReview;
USE KinderReview;


CREATE TABLE `member`(
    id INT UNSIGNED PRIMARY KEY AUTO_INCREMENT
    , regDate DATETIME NOT NULL
    , updateDate DATETIME NOT NULL
    , loginId VARCHAR(50) NOT NULL UNIQUE
    , loginPw VARCHAR(100) NOT NULL
    , nickname VARCHAR(50) NOT NULL
    , email VARCHAR(100) NOT NULL
);

ALTER TABLE `member` DROP COLUMN email;


DROP TABLE IF EXISTS article_option;
DROP TABLE IF EXISTS article;
DELETE FROM article WHERE welfareScore =3;

CREATE TABLE article(
    id INT UNSIGNED PRIMARY KEY AUTO_INCREMENT,
    regDate DATETIME NOT NULL,
    updateDate DATETIME NOT NULL,
    memberId INT UNSIGNED NOT NULL,
    boardId INT UNSIGNED NOT NULL,
    institutionName VARCHAR(255),
    content TEXT NOT NULL,
    salaryScore INT DEFAULT 0,
    welfareScore INT DEFAULT 0,
    environmentScore INT DEFAULT 0,
    salaryComment TEXT,
    welfareComment TEXT,
    environmentComment TEXT,
    workType VARCHAR(100),
    city VARCHAR(100),
    district VARCHAR(100),
    institutionType VARCHAR(100)
);
ALTER TABLE article ADD COLUMN commuteTimeComment TEXT AFTER environmentComment;
ALTER TABLE article DROP COLUMN district;
ALTER TABLE article DROP COLUMN content;
ALTER TABLE article ADD COLUMN institutionComment TEXT AFTER institutionName;

CREATE TABLE article_option (
    id INT UNSIGNED PRIMARY KEY AUTO_INCREMENT,
    articleId INT UNSIGNED NOT NULL,
    TYPE VARCHAR(20) NOT NULL, -- 'salary', 'welfare', 'environment'
    VALUE VARCHAR(100) NOT NULL,
    FOREIGN KEY (articleId) REFERENCES article(id) ON DELETE CASCADE
);

DROP TABLE IF EXISTS board;

CREATE TABLE board(
    id INT UNSIGNED PRIMARY KEY AUTO_INCREMENT
    , `name` VARCHAR(50) NOT NULL
);

 
SELECT * FROM board;
SELECT * FROM article;
SELECT * FROM `member`;
SELECT * FROM likePoint;
SELECT * FROM reply;
SELECT * FROM article_option;

INSERT INTO board
    SET `name` = '기관 정보';

INSERT INTO board
    SET `name` = '기관 리뷰';
    
INSERT INTO board
    SET `name` = '지역별 커뮤니티';

INSERT INTO board
    SET `name` = '근무 리뷰';
    
INSERT INTO board
    SET `name` = '면접 리뷰';
    
INSERT INTO board
    SET `name` = '실습 및 봉사 리뷰';

INSERT INTO board
    SET `name` = '유치원 정보';
    
INSERT INTO board
    SET `name` = '어린이집 정보';
    
INSERT INTO article
    SET regDate = NOW()
        , updateDate = NOW()
        , memberId = 1
        , boardId = 2
        , institutionName = '기관명 예시'
        , institutionComment = '기관명 한줄평'
        , city = '서울'
        , workType = '담임교사'
        , institutionType = '어린이집'
        , salaryScore = 4
        , welfareScore = 3
        , environmentScore = 5
        , salaryComment = '급여 만족'
        , welfareComment = '복지 괜찮음'
        , environmentComment = '환경 좋아요'
        , commuteTimeComment = '8:00~ 19:00';

DELETE FROM article 
WHERE memberId = 1;      
        
INSERT INTO `member`
    SET regDate = NOW()
        , updateDate = NOW()
        , loginId = 'test1'
        , loginPw = 'test1'
        , nickname = '유저1';

INSERT INTO `member`
    SET regDate = NOW()
        , updateDate = NOW()
        , loginId = 'test2'
        , loginPw = 'test2'
        , nickname = '유저2';